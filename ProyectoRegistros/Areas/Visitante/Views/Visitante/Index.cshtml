@model IEnumerable<ProyectoRegistros.Areas.Visitante.Models.ViewModels.TalleresViewModel>
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "LayoutVisit";
}

<header class="principal">
    <div class="izq">
        <i class="menu material-symbols-outlined">menu</i>
        <h2>Talleres</h2>
    </div>
    <img id="ig2" src="~/img/Historial.png" />
</header>

<div class="filtros">
    <div class="buscador">
        <input type="search" id="search-visitante" name="searchTerm"
               placeholder="Buscar"
               value="@ViewData["CurrentFilter"]" />
    </div>
</div>

<div id="tabla-container">
    @await Html.PartialAsync("_VisitanteTalleresTabla", Model)
</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {

            const searchInput = document.getElementById('search-visitante');
            const tablaContainer = document.getElementById('tabla-container');
            let debounceTimer;

            function actualizarTabla() {
                const searchTerm = searchInput.value;
                const url = `@Url.Action("Index", "Visitante")?searchTerm=${encodeURIComponent(searchTerm)}`;

                fetch(url, {
                    method: 'GET',
                    headers: { 'X-Requested-With': 'XMLHttpRequest' }
                })
                .then(response => response.text())
                .then(html => {
                    tablaContainer.innerHTML = html;
                })
                .catch(error => console.error('Error al actualizar la tabla:', error));
            }

            searchInput.addEventListener('input', () => {
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(actualizarTabla, 300);
            });

        });
    </script>
